# Week of 2024-12-02 to 2024-12-09 (29)

### GHFirst (16)

- [Revert "[Inductor] Represent size_hints as a dict (#142249)"](https://github.com/pytorch/pytorch/commit/fc831f76f8f924f9f2478b4659ff664bfee39edb)
  - would break internal tests ([comment](https://github.com/pytorch/pytorch/pull/142249#issuecomment-2524991008))
- [Revert "[Inductor] Expand dtype aware codegen for libdevice and tl.math ops (#140864)"](https://github.com/pytorch/pytorch/commit/f36cccba2e55b0b5a5123b82780c7f68505553a9)
  - failing internally ([comment](https://github.com/pytorch/pytorch/pull/140864#issuecomment-2524168602))
- [Revert "[Inductor] Constrain the shape of other tensor for Conv/Linear + broadcast add fusion. (#141759)"](https://github.com/pytorch/pytorch/commit/3fd51e079db5e2ed28a7f8a83ab6f13d0c6eddcd)
  - Failing internally ([comment](https://github.com/pytorch/pytorch/pull/141759#issuecomment-2523983558))
- [Revert "export AOTI_TORCH_EXPORT on Windows. (#140030)"](https://github.com/pytorch/pytorch/commit/db13bd9ac2db509219148f9a084c7b99f785c1d7)
  - Break internal tests see errors like: csrc\inductor\aoti_torch\shim_common.cpp(481): error C2491: 'aoti_torch__embedding_bag': definition of dllimport function not allowed ([comment](https://github.com/pytorch/pytorch/pull/140030#issuecomment-2523968128))
- [Revert "[FSDP2] Move to public `torch.distributed.fsdp` (#141868)"](https://github.com/pytorch/pytorch/commit/bab15df40a9a04034512c1fa9d75cb3304ba1ae0)
  - failing internally ([comment](https://github.com/pytorch/pytorch/pull/141868#issuecomment-2523925180))
- [Revert "E2E composability testing (#141398)"](https://github.com/pytorch/pytorch/commit/4af7aa5e645bbc11a8521b2acc00946b8eaaa8cd)
  - Sorry need to revert https://github.com/pytorch/pytorch/pull/141868, we can try rebase and reland this after ([comment](https://github.com/pytorch/pytorch/pull/141398#issuecomment-2523908998))
- [Revert "Unbreak dynamic shape minimal arrayref interface tests (#142091)"](https://github.com/pytorch/pytorch/commit/683ec42958c21181408add02a3b407c16b1473c7)
  - Breaks internal changes ([comment](https://github.com/pytorch/pytorch/pull/142091#issuecomment-2523906048))
- [Revert "[ATen][Native][Special] Hermite polynomial prematurely return NaN if n is high (#141955)"](https://github.com/pytorch/pytorch/commit/cb70d9fd05ae9ab2eab5aeaac194440fd578fe58)
  - Failing internal test ([comment](https://github.com/pytorch/pytorch/pull/141955#issuecomment-2521024701))
- [Revert "[dynamo] Simplify handling of `functools.wraps` (#142000)"](https://github.com/pytorch/pytorch/commit/ca9aeedf407f9b2eed9a66a52904a2b595ef9eda)
  - Newly added test test_functions.py::DefaultsTests::test_tree_map is failing internally ([comment](https://github.com/pytorch/pytorch/pull/142000#issuecomment-2520611808))
- [Revert "[dynamo] Remove workaround for `functools.wraps` in functorch (#142014)"](https://github.com/pytorch/pytorch/commit/86d08f0b4acd50c700b5e20821e82b5f51cbfaa6)
  - Sorry https://github.com/pytorch/pytorch/pull/142000 is failing internally, need to revert this ([comment](https://github.com/pytorch/pytorch/pull/142014#issuecomment-2520601186))
- [Revert "[ROCm] port CK rowwise F8 from fbgemm (#140856)"](https://github.com/pytorch/pytorch/commit/dbd7b820dd5f35517aef4ffdb21017baf2b15cfd)
  - Failing internal build ([comment](https://github.com/pytorch/pytorch/pull/140856#issuecomment-2518911997))
- [Revert "[Inductor] Represent tiling as a dict (#141751)"](https://github.com/pytorch/pytorch/commit/38d10a1b1755c17ab6f848c2cf3a22fcb35b5bc9)
  - Failing internal builds ([comment](https://github.com/pytorch/pytorch/pull/141751#issuecomment-2517815899))
- [Revert "Add missing data types at torch export serialization (#138561)"](https://github.com/pytorch/pytorch/commit/09ce760fef7e46fa7e204af51d7a3de939fa72b7)
  - Diff reverted internally ([comment](https://github.com/pytorch/pytorch/pull/138561#issuecomment-2513343401))
- [Revert "[inductor][pattern matcher] revise mkldnn pattern matcher UT (#141334)"](https://github.com/pytorch/pytorch/commit/b47bdb06d8cb9ffb2c8613ae2f8f72b09057ace9)
  - Failing internally ([comment](https://github.com/pytorch/pytorch/pull/141334#issuecomment-2512891840))
- [Revert "[dynamo][pytree][1/N] make CXX pytree traceable: `tree_iter` / `tree_leaves` (#137397)"](https://github.com/pytorch/pytorch/commit/9012e7a62f756f7cf42e73d7dd375f8c468a0c66)
  - Failing internal test ([comment](https://github.com/pytorch/pytorch/pull/137397#issuecomment-2511934283))
- [Revert "export AOTI_TORCH_EXPORT on Windows. (#140030)"](https://github.com/pytorch/pytorch/commit/90f4d60672fb1f0651fe052c3e0ea5022f163615)
  - need to fix on XPU. ([comment](https://github.com/pytorch/pytorch/pull/140030#issuecomment-2510737212))

### Ignored Signal (2)

- [Revert "export AOTI_TORCH_EXPORT on Windows. (#140030)"](https://github.com/pytorch/pytorch/commit/41952c1876f81ff981ae955e76f515967bcaa404)
  - This broke sm89 builds ([comment](https://github.com/pytorch/pytorch/pull/140030#issuecomment-2521290457))
- [Revert "Fix NOLINTNEXTLINE (#141794)"](https://github.com/pytorch/pytorch/commit/eb7deb2db5de18ce5bf9bfa6c3b3e84d5cd1b359)
  - [GH job link](https://github.com/pytorch/pytorch/actions/runs/12087979418/job/33711943084) [HUD commit link](https://hud.pytorch.org/pytorch/pytorch/commit/7dd9b5fc4343d101294dbbab4b4172f2859460bc) ([comment](https://github.com/pytorch/pytorch/pull/141794#issuecomment-2511789484))

### Landrace (3)

- [Revert "[ROCm] unskip hermite_polynomial_h unit tests (#141150)"](https://github.com/pytorch/pytorch/commit/90052a8ae2cc8cef20ec49037f886c2b811ed41b)
  - this PR is tied to #141955 and that one was reverted so need to revert this too ([comment](https://github.com/pytorch/pytorch/pull/141150#issuecomment-2521830067))
- [Revert "[REFACTOR] Inline FxGraphCache.post_compile into sole call site (#141877)"](https://github.com/pytorch/pytorch/commit/2999dbfd219f32e8e416d3957b79f443847b7e7b)
  - Job are failing en masse after this lands, so it looks like a land race ([comment](https://github.com/pytorch/pytorch/pull/141877#issuecomment-2513552752))
- [Revert "[REFACTOR] Inline FxGraphCache.post_compile into sole call site (#141877)"](https://github.com/pytorch/pytorch/commit/6b05e31042ab0839b6cfa64d6329088ca96dae93)
  - Sorry for reverting your change, but a lot of failures shows up after this lands ([comment](https://github.com/pytorch/pytorch/pull/141877#issuecomment-2512890426))

### Not through pytorchbot (1)

- [Back out "[Reland][Environment Variable][5/N] Use thread-safe getenv functions (#140594)" (#142226)](https://github.com/pytorch/pytorch/commit/022cbf2f3106d04e4a502816f6eda8615911a486)

### No Signal (5)

- [Revert "Respect ROCR_VISIBLE_DEVICES on AMD GPU device discovery (#140320)"](https://github.com/pytorch/pytorch/commit/40d1b5f4905b17a3bf8695984b169e8b661a9711)
  - Sorry for reverting your change but test_hip_device_count is failing in trunk after this land ([comment](https://github.com/pytorch/pytorch/pull/140320#issuecomment-2524742845))
- [Revert "[reland][dynamo][guards] Consider tensors as immutable for dict tag matches (#141085)"](https://github.com/pytorch/pytorch/commit/e7de245ee1d932fc79cc48376a621494e5dbe18e)
  - internal regression ([comment](https://github.com/pytorch/pytorch/pull/141085#issuecomment-2522403360))
- [Revert "[BE]: Update mypy to 1.13.0 (#140808)"](https://github.com/pytorch/pytorch/commit/daa77f3d9f2a81cc0d1011a5a901cd0f6070fa98)
  - This is failing a distributed test in trunk, target determination missed this test and did not run it on PR ([comment](https://github.com/pytorch/pytorch/pull/140808#issuecomment-2512788426))
- [Revert "Ensure that BlockMask length must always exactly match the sequence length in flex_attention (#141625)"](https://github.com/pytorch/pytorch/commit/a34a56f69f7415ae55e632156e65e8b21ffce5d9)
  - Broken main ([comment](https://github.com/pytorch/pytorch/pull/141625#issuecomment-2511639687))
- [Revert "ILP for auto FSDP wrapping (#140298)"](https://github.com/pytorch/pytorch/commit/ec96597e47760de6d47ee20edf78ed192edbce43)
  - for other PR ([comment](https://github.com/pytorch/pytorch/pull/140298#issuecomment-2511638743))

### Weird (2)

- [Revert "[3/N] Avoid copy in std::get (#141843)"](https://github.com/pytorch/pytorch/commit/4a6c056466b990e1ceb6b45aa8d66236ca675c2d)
  - Sorry fo reverting your change but a bunch of CUDA builds are failing in trunk after this lands due to OOM ([comment](https://github.com/pytorch/pytorch/pull/141843#issuecomment-2522335911))
- [Revert "Set remote cache version and backend type once in compilation metrics (#141707)"](https://github.com/pytorch/pytorch/commit/ce8611950368812d378b19e7b72b02204e3a4186)
  - It breaks tests by referencing FbRemoteFxGraphCache, but CI was green ([comment](https://github.com/pytorch/pytorch/pull/141707#issuecomment-2513555185))
