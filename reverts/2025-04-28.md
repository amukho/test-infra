# Week of 2025-04-28 to 2025-05-05 (28)

### GHFirst (5)

- [Revert "Avoid triggering ignored requires_grad warning in our code (#152686)"](https://github.com/pytorch/pytorch/commit/8dbe1ff34b8d4e2ef9bc2334069782b53d91678f)
  - failinginternal test, discussed with author ([comment](https://github.com/pytorch/pytorch/pull/152686#issuecomment-2849497208))
- [Revert "[inductor] Realize bucketize/searchsorted output (#152644)"](https://github.com/pytorch/pytorch/commit/8faa22569519b8916dfa0334287cbb849704965f)
  - Diff reverted internally ([comment](https://github.com/pytorch/pytorch/pull/152644#issuecomment-2848743442))
- [Revert "Enable -Wunused on torch targets (#150077)"](https://github.com/pytorch/pytorch/commit/6dadfc445704f4002c595930ced3bd1e0363f14a)
  - failing internally with use of undeclared identifier ([comment](https://github.com/pytorch/pytorch/pull/150077#issuecomment-2846499828))
- [Revert "Use swap_tensors path in nn.Module.to for all subclasses that override __torch_dispatch__ (#152539)"](https://github.com/pytorch/pytorch/commit/4f9f1abd6d59bc427142b3621e5ebdf3009c750a)
  - failing internal tests - discussed with author ([comment](https://github.com/pytorch/pytorch/pull/152539#issuecomment-2846484924))
- [Revert "[cudagraphs] Fix issue in collecting static_input_idxs (#152287)"](https://github.com/pytorch/pytorch/commit/a6d19fcfacf8b7f860ab006d90571bdb245c08a7)
  - causing ao failures - discussed with author ([comment](https://github.com/pytorch/pytorch/pull/152287#issuecomment-2837686127))

### Ignored Signal (12)

- [Revert "[BE] Update numba versions (#152557)"](https://github.com/pytorch/pytorch/commit/e6989ceea964a2ebc31cda8a3bb0402109beb2dd)
  - test_unary_funcs failure seems real? [GH job link](https://github.com/pytorch/pytorch/actions/runs/14787082066/job/41518415014) [HUD commit link](https://hud.pytorch.org/pytorch/pytorch/commit/b5995cb67f8543f148b9216e140980e6844aadff) ([comment](https://github.com/pytorch/pytorch/pull/152557#issuecomment-2846336004))
- [Revert "[torchgen] Refactor `torchgen.utils.FileManager` to accept `pathlib.Path` (#150726)"](https://github.com/pytorch/pytorch/commit/1c04ea4e5909e3fa879230891423cb363f045136)
  - This breaks Windows builds, see https://hud.pytorch.org/hud/pytorch/pytorch/a765e2ddda3c84a4b3d90d0f698fb7c058a19153/1?per_page=50&name_filter=win&mergeEphemeralLF=true ([comment](https://github.com/pytorch/pytorch/pull/150726#issuecomment-2845858846))
- [Revert "[inductor][invoke_subgraph] Remove assertion checks for outputs of invoke_subgraph (#152384)"](https://github.com/pytorch/pytorch/commit/4c8dee7986d0da5cd8485b8d84323c425d228891)
  - Broke CI, see https://hud.pytorch.org/hud/pytorch/pytorch/52cbcac640dc1d8c12a6f8308799c75d45c6fc4a/1?per_page=50&name_filter=pull%20%2F%20linux-focal-cuda12.6-py3.10-gcc11-sm89%20%2F%20test&mergeEphemeralLF=true ([comment](https://github.com/pytorch/pytorch/pull/152384#issuecomment-2845099985))
- [Revert "[inductor][subgraph] Simplify the resulting output code for subgraph (#152383)"](https://github.com/pytorch/pytorch/commit/f7b60456cc4d6d5a71ef25a0bf90196ffe313c23)
  - Broke CI, see https://hud.pytorch.org/hud/pytorch/pytorch/52cbcac640dc1d8c12a6f8308799c75d45c6fc4a/1?per_page=50&name_filter=pull%20%2F%20linux-focal-cuda12.6-py3.10-gcc11-sm89%20%2F%20test&mergeEphemeralLF=true ([comment](https://github.com/pytorch/pytorch/pull/152384#issuecomment-2845099985))
- [Revert "[invoke_subgraph] Simplify output code for subgraph output node (#152490)"](https://github.com/pytorch/pytorch/commit/2f1800bc3d5ec030872651ea52782941ab188db6)
  - Broke CI, see https://hud.pytorch.org/hud/pytorch/pytorch/52cbcac640dc1d8c12a6f8308799c75d45c6fc4a/1?per_page=50&name_filter=pull%20%2F%20linux-focal-cuda12.6-py3.10-gcc11-sm89%20%2F%20test&mergeEphemeralLF=true ([comment](https://github.com/pytorch/pytorch/pull/152384#issuecomment-2845099985))
- [Revert "[inductor][invoke_subgraph] Free the buffers before the subgraph call (#152494)"](https://github.com/pytorch/pytorch/commit/2fa39e60ed27ee667f8115932d2bc1bf2ecc07f8)
  - Broke CI, see https://hud.pytorch.org/hud/pytorch/pytorch/52cbcac640dc1d8c12a6f8308799c75d45c6fc4a/1?per_page=50&name_filter=pull%20%2F%20linux-focal-cuda12.6-py3.10-gcc11-sm89%20%2F%20test&mergeEphemeralLF=true ([comment](https://github.com/pytorch/pytorch/pull/152384#issuecomment-2845099985))
- [Revert "[CUDAGraph Trees] support memory allocation on side stream (#152472)"](https://github.com/pytorch/pytorch/commit/56039b57782a45edf92859c4a9cb87228e47ac5e)
  - should use tid instead pid ([comment](https://github.com/pytorch/pytorch/pull/152472#issuecomment-2843491656))
- [Revert "[inductor][BE] Add more debug logs for why fx graph cache doesn't happen (#152487)"](https://github.com/pytorch/pytorch/commit/49a72011cc68a5f0eacad2caf83343c9aafec498)
  - And it broke those tests, not sure why signal was ignored ([comment](https://github.com/pytorch/pytorch/pull/152487#issuecomment-2843333471))
- [Revert "Change test/inductor/test_standalone_compile to test/inductor/test_compile (#152103)"](https://github.com/pytorch/pytorch/commit/702264dad4eb5c6ea66e1cec946711599c9ef188)
  - failure is real but log classifier is pointing at an unrelated line, actual failure is just that the old name is mentioned somewhere and needs to be changed, see the bottom of the test step of the job https://github.com/pytorch/pytorch/actions/runs/14740884246/job/41379127184#step:22:705 [GH job link](https://github.com/pytorch/pytorch/actions/runs/14758321324/job/41434697413) [HUD commit link](https://hud.pytorch.org/pytorch/pytorch/commit/ff1099562d261315ac7bbf43f3795872099a1c31) ([comment](https://github.com/pytorch/pytorch/pull/152103#issuecomment-2842638551))
- [Revert "Fix flaky test in test_custom_ops (#152484)"](https://github.com/pytorch/pytorch/commit/371999782a0e2a977fa1be663dd34e8b581ea1e5)
  - It broke test_save to file with TypeError: get_sample_op_profile() missing 1 required argument ([comment](https://github.com/pytorch/pytorch/pull/152484#issuecomment-2842254907))
- [Revert "[PT2] Port replace_lce_with_matmul / replace_first_lce_with_fused_matmul_lce to PT2 pre_grad passes (#152450)"](https://github.com/pytorch/pytorch/commit/7a9d0d2451957b1fe95c70c70f426c6d13d7d0fd)
  - still failing after https://github.com/pytorch/pytorch/pull/152493 - needs further investigation ([comment](https://github.com/pytorch/pytorch/pull/152450#issuecomment-2841212970))
- [Revert "fix tests broken after #152450 (#152493)"](https://github.com/pytorch/pytorch/commit/424e21ae82c196158505f5ef2b74fb214fea5c05)
  - still failing ([comment](https://github.com/pytorch/pytorch/pull/152493#issuecomment-2841207942))

### No Signal (10)

- [Revert "[ROCm] Upgrade ROCm CI to ROCm6.4 (#151368)"](https://github.com/pytorch/pytorch/commit/cc28b43950462099c475892858dafd114aad75ec)
  - This broke inductor cpp wrapper ([comment](https://github.com/pytorch/pytorch/pull/151368#issuecomment-2848519706))
- [Revert "[cutlass backend] Minor lru_cache to slightly speed up filtering ops (#152577)"](https://github.com/pytorch/pytorch/commit/50d4698ac8c12ad8399773aa157d25316c7c345e)
  - failing test_unary_ufuncs.py::TestUnaryUfuncsCUDA::test_reference_numerics_large_jiterator_unary_cuda_complex64 [GH job link](https://github.com/pytorch/pytorch/actions/runs/14787347116/job/41519095088) [HUD commit link](https://hud.pytorch.org/pytorch/pytorch/commit/1fef3cdabc3f79fd0cbf9273052057ef6122710f) ([comment](https://github.com/pytorch/pytorch/pull/152577#issuecomment-2846544603))
- [Revert "[Inductor] Add decomposeK as an autotuning choice for mm (#150654)"](https://github.com/pytorch/pytorch/commit/7c3e679ddd504e6725ff06db88d2e4e4f1f1e309)
  - Failing ROCM tests: inductor/test_subgraph_choice.py::TestSubgraphChoice::test_subgraph_decompose_k [GH job link](https://github.com/pytorch/pytorch/actions/runs/14786111108/job/41515742446) [HUD commit link](https://hud.pytorch.org/pytorch/pytorch/commit/3c54e0c21660bf6e2bf405a6aa4b9b66fd34c7b4) ([comment](https://github.com/pytorch/pytorch/pull/150654#issuecomment-2846470409))
- [Revert "[MPS][BE] Delete unused lerp functors (#152443)"](https://github.com/pytorch/pytorch/commit/e35e31697eb89177d0bc4f9490cafa0bb41b6c9d)
  - failing MPS test: test/test_optim.py::TestOptimRenewedMPS::test_can_load_from_to_named_state_dict_is_named_optim0_False_is_named_optim1_False_Adafactor_mps_float32 ([comment](https://github.com/pytorch/pytorch/pull/152443#issuecomment-2840405966))
- [Revert "Add detailed triton kernel logging to tlparse (#152197)"](https://github.com/pytorch/pytorch/commit/fecaa60c3c3ee183ccb40c0c05c2b8d85284f733)
  - failing     python test/dynamo/test_structured_trace.py StructuredTraceTest.test_cudagraphs on trunk ([comment](https://github.com/pytorch/pytorch/pull/152197#issuecomment-2840400839))
- [Revert "[AOTI][reland] Remove typedef for half and bfloat16 (#151109)"](https://github.com/pytorch/pytorch/commit/471025c4898bb8c87319af1332fb18ff9b748a54)
  - causing AOTI test failures - discussed with author ([comment](https://github.com/pytorch/pytorch/pull/151109#issuecomment-2840386483))
- [Revert "[OpenReg] Add _lazy_init and rng_state support for OpenReg (#151914)"](https://github.com/pytorch/pytorch/commit/3962b8f1e0cb5c4cef0beb744fdc775cdcaef09d)
  - Looks like breaks number of ROCM jobs, see https://hud.pytorch.org/hud/pytorch/pytorch/797768cd90d0984687e15f5fe0e1a4d8bf91d71a/1?per_page=50&name_filter=rocm%20%2F%20linux&mergeEphemeralLF=true ([comment](https://github.com/pytorch/pytorch/pull/151914#issuecomment-2839691038))
- [Revert "[Relandx2] Rewrite the guts of torch::jit::Lexer to speed it up   (#152372)"](https://github.com/pytorch/pytorch/commit/46419c78997c556b6c9df7bc2cfb208b4cc69d49)
  - Looks like it broke distributed this time around, see https://hud.pytorch.org/hud/pytorch/pytorch/f05d3e5019a8d0ee460bb96d490764977cc2d011/1?per_page=50&name_filter=distributed&mergeEphemeralLF=true ([comment](https://github.com/pytorch/pytorch/pull/152372#issuecomment-2837426497))
- [Revert "Reapply "Rewrite the guts of torch::jit::Lexer to speed it up (#151850)" (#152250)"](https://github.com/pytorch/pytorch/commit/e7c19f4f6930925c32cbc20188411940557781b7)
  - Breaks s390, may be time to move build back to opt-in https://hud.pytorch.org/hud/pytorch/pytorch/2667cb69d92f5a5304679ac8062b1e1c41428cdc/1?per_page=50&name_filter=s390&mergeEphemeralLF=true ([comment](https://github.com/pytorch/pytorch/pull/152250#issuecomment-2836833030))
- [Revert "[Inductor UT] Generalize device-bias code in `test_flex_attention.py` (#151937)"](https://github.com/pytorch/pytorch/commit/9c864f9b0f158016a6d2069185173eb9ceb0abd8)
  - Broke ASAN tests, probably by enabling too many tests https://hud.pytorch.org/hud/pytorch/pytorch/main/1?per_page=50&name_filter=asan&mergeEphemeralLF=true ([comment](https://github.com/pytorch/pytorch/pull/151937#issuecomment-2835151532))

### Weird (1)

- [Revert "fix tests broken after #152450 (#152493)"](https://github.com/pytorch/pytorch/commit/cc7346bf19c019255dcb4484694a75850ed74d5a)
  - Another tweak is needed https://github.com/pytorch/pytorch/actions/runs/14748144909/job/41399954902, seem easier to revert and reland this ([comment](https://github.com/pytorch/pytorch/pull/152493#issuecomment-2841010528))
